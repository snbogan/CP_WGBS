---
title: "01_diff_meth"
author: "Sam Bogan"
date: "2025-06-18"
output: html_document
---

All commands run on UCSC Hummingbird cluster

```{r setup, include=FALSE}
knitr::opts_knit$set(root.dir = '/hb/home/snbogan/WGBS/Cross')

library(tidyverse)
library(edgeR)

```

### Allocate interactive SLURM session

```{bash}

# Start interactive session
salloc --account=pi-jkoc --partition=lab-colibri --qos=pi-jkoc --ntasks=1 --cpus-per-task=8 --mem=120G --time=12:00:00

```


### Read in and wrangle coverage files

```{r}

# Create list of .cov objects in 01 input data
cov_list <- list.files(path = "input_data", 
                        pattern = "\\.cov$", 
                        full.names = TRUE)
# Read in list
samples <- gsub("_1.CpG.merged.cov.CpG_report.merged_CpG_evidence.cov",
                        "", basename(cov_list))

yall <- readBismark2DGE(cov_list, sample.names = samples)

# Read in targets df for edgeR model
targets <- read.csv("input_data/sample_meta_data.csv")

```

